#!/usr/bin/env bash
set -e  # Exit on any command failure

# Load NVM if available
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"

# Add common paths for pnpm
export PATH="$HOME/.nvm/versions/node/$(node -v)/bin:$PATH"

echo "ğŸ” Running pre-commit checks..."

echo "ğŸ“ Running lint..."
if ! pnpm run lint; then
    echo "âŒ Lint failed! Please fix the issues before committing."
    exit 1
fi

echo "ğŸ—ï¸ Running build..."
if ! NODE_OPTIONS="--max-old-space-size=8192" pnpm run build; then
    echo "âŒ Build failed! Please fix the issues before committing."
    exit 1
fi

echo "âœ… Pre-commit checks passed!"
